{% extends "base.html" %}

{% block css %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='search.css') }}">
{% endblock css %}

{% block mediaquery %}
<style>
/* ----------- iPhone 5, 5S, 5C and 5SE ----------- */
/* Portrait */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 568px)
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: portrait) {
    .card {
        width: 100%;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .project-title {
        font-size: 0.7em;
    }
}
/* Landscape */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 568px)
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: landscape) {
    .card {
        width: 100%;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .project-title {
        font-size: 0.8em;
    }
}

/* ----------- iPhone 6, 6S, 7, and 8 ----------- */
/* Portrait */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 667px) 
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: portrait) { 
    .card {
        width: 100%;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .project-title {
        font-size: 0.8em;
    }
}
/* Landscape */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 667px) 
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: landscape) { 
    .card {
        width: 100%;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .project-title {
        font-size: 0.9em;
    }
}

/* ----------- iPhone 6+, 7+ and 8+ ----------- */
/* Portrait */
@media only screen 
  and (min-device-width: 414px) 
  and (max-device-width: 736px) 
  and (-webkit-min-device-pixel-ratio: 3)
  and (orientation: portrait) { 
    .card {
        width: 100%;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .project-title {
        font-size: 0.8em;
    }
}
/* Landscape */
@media only screen 
  and (min-device-width: 414px) 
  and (max-device-width: 736px) 
  and (-webkit-min-device-pixel-ratio: 3)
  and (orientation: landscape) { 
    .card {
        width: 100%;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .project-title {
        font-size: 0.9em;
    }
}

/* ----------- iPhone X ----------- */
/* Portrait */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 812px) 
  and (-webkit-min-device-pixel-ratio: 3)
  and (orientation: portrait) { 
    .card {
        width: 100%;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .project-title {
        font-size: 0.8em;
    }
}

/* Landscape */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 812px) 
  and (-webkit-min-device-pixel-ratio: 3)
  and (orientation: landscape) { 
    .card {
        width: 100%;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .project-title {
        font-size: 0.9em;
    }
}

/* ----------- Galaxy S4, S5 and Note 3 ----------- */
/* Portrait */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: portrait) {
    .card {
        width: 100%;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .project-title {
        font-size: 0.7em;
    }
}
/* Landscape */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: landscape) {
    .card {
        width: 100%;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .project-title {
        font-size: 0.8em;
    }
}

/* ----------- Galaxy S6 ----------- */
/* Portrait */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 4) 
  and (orientation: portrait) {
    .card {
        width: 100%;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .project-title {
        font-size: 0.8em;
    }
}
/* Landscape */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 4) 
  and (orientation: landscape) {
    .card {
        width: 100%;
    }
    .card-ul {
        padding-bottom: 4em;
    }
    .card-ul li {
        height: 15em;
    }
    .project-created-date,
    .project-likes {
        display: none;
    }
    .project-title {
        font-size: 0.9em;
    }
}
</style>
{% endblock mediaquery %}

{% block bodycontent %}
<div class="search-container">
    <div class="container">
        <div class="row">
            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 my-2">
                <div class="card">
                    <div class="card-content">
                        <div class="card-header card-header-search">
                            <h1 class="card-heading">Search Results</h1>
                        </div>
                        <div class="card-body custom-scrollbar">
                            <div class="card-p">
                                {% if projects %}
                                <ul class="card-ul">
                                    {% for project in projects %}
                                    {% if project.private != True %}
                                    {% set created = moment(project.created_date).format('LL') %}
                                    <li>
                                        <p class="project-title"><a class="project-title-link project-title-link-{{ project.id }}" href="{{ url_for('project.project', username=project.username, title=project.title) }}" data-toggle="popover" data-popover="true" data-html="true" data-content='<div class="popover-container popover-container-{{ project.id }}"><span class="popover-created-date"><strong>Created on: </strong></span><img class="popover-avatar" src="{{ project.author.avatar(40) }}"><a class="popover-userlink" href="{{ url_for("main.profile", username=project.username) }}" target="blank">{{ project.username }}</a><p class="popover-description">{{ project.description }}</p></div>'>{{ project.title }}</a></p>
                                        <span class="project-created-date"><strong>Created on : </strong> {{ created }}</span>
                                        <span class="project-likes"><strong>{{ project.likes }} </strong> Likes</span>
                                        <p class="project-description custom-scrollbar">{{ project.description }}</p>
                                        <p class="project-tags custom-scrollbar">Tags: 
                                            {% if project.aquariums == True %}<a href="{{ url_for('project.tagsearch', tag='aquariums') }}"> Aquariums</a>,{% endif %}
                                            {% if project.saltwater == True %}<a href="{{ url_for('project.tagsearch', tag='saltwater') }}"> Saltwater</a>,{% endif %}
                                            {% if project.freshwater == True %}<a href="{{ url_for('project.tagsearch', tag='freshwater') }}"> Freshwater</a>,{% endif %}
                                            {% if project.terrariums == True %}<a href="{{ url_for('project.tagsearch', tag='terrariums') }}"> Terrariums</a>,{% endif %}
                                            {% if project.enclosedtropical == True %}<a href="{{ url_for('project.tagsearch', tag='enclosedtropical') }}"> Enclosed Tropical</a>,{% endif %}
                                            {% if project.opentropical == True %}<a href="{{ url_for('project.tagsearch', tag='opentropical') }}"> Open Tropical</a>,{% endif %}
                                            {% if project.carnivorous == True %}<a href="{{ url_for('project.tagsearch', tag='carnivorous') }}"> Carnivorous</a>,{% endif %}
                                            {% if project.desert == True %}<a href="{{ url_for('project.tagsearch', tag='desert') }}"> Desert</a>,{% endif %}
                                            {% if project.reptiles == True %}<a href="{{ url_for('project.tagsearch', tag='reptiles') }}"> Reptiles</a>,{% endif %}
                                            {% if project.vivariumpaludarium == True %}<a href="{{ url_for('project.tagsearch', tag='vivariumpaludarium') }}"> Vivarium/Paludarium</a>,{% endif %}
                                            {% if project.waterreptiles == True %}<a href="{{ url_for('project.tagsearch', tag='waterreptiles') }}"> Water Reptiles</a>,{% endif %}
                                            {% if project.plantsonly == True %}<a href="{{ url_for('project.tagsearch', tag='plantsonly') }}"> Plants only</a>,{% endif %}
                                            {% if project.difficulty < 4 %}<a href="{{ url_for('project.tagsearch', tag='difficulty', value='easy') }}"> Easy</a>,{% elif project.difficulty > 7 %}<a href="{{ url_for('project.tagsearch', tag='difficulty', value='hard') }}"> Hard</a>,{% else %}<a href="{{ url_for('project.tagsearch', tag='difficulty', value='medium') }}"> Medium</a>,{% endif %}
                                            {% if project.cost < 100 %}<a href="{{ url_for('project.tagsearch', tag='cost', value='$') }}"> $</a>,{% elif project.cost > 100 %}<a href="{{ url_for('project.tagsearch', tag='cost', value='$$') }}"> $$</a>,{% elif project.cost > 300 %}<a href="{{ url_for('project.tagsearch', tag='cost', value='$$$') }}"> $$$</a>,{% elif project.cost > 600 %}<a href="{{ url_for('project.tagsearch', tag='cost', value='$$$$') }}"> $$$$</a>,{% elif project.cost > 1000 %}<a href="{{ url_for('project.tagsearch', tag='cost', value='$$$$$') }}"> $$$$$</a>,{% endif %}
                                        </p>
                                    </li>
                                    {% endif %}
                                    {% endfor %}
                                </ul>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock bodycontent %}

{% block scripts %}
{{ super() }}
<script>
/* POPOVER EFFECTS */
$(function() {
    $("[data-toggle=popover]").each(function(i, obj) {
        $(this)
            .popover({
                html: true,
                container: 'body',
                viewport: {selector: '.search-container'},
                selector: '[data-popover]',
                trigger: 'hover',
                placement: 'top',
            })
            .on("mouseenter", function() {
                var _this = this;
                setTimeout(function() {
                    $(_this).popover("show");
                }, 600);
                $(".popover").on("mouseleave", function() {
                    $(_this).popover("hide");
                });
            })
            .on("mouseleave", function() {
                var _this = this;
                setTimeout(function() {
                    if (!$(".popover:hover").length) {
                    $(_this).popover("hide");
                    }
                }, 400);
            });
        });
});

/* UNIVERSALLY CLOSES ANY STUCK POPOVERS */
$(function() {
    $('.card-body, .search-container').on('mouseenter', () => {
        $('.project-title-link').popover('hide');
    });
});

</script>
{% endblock scripts %}