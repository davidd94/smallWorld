<style>
.chatbox-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 60vh;
  background-color: #b3d4fc;
  position: fixed;
  bottom: 0;
  right: 0;
}

.users-list-card {
  margin: 10px;
  height: 97%;
  max-width: 448px;
}

.users-list-card > .mdl-list {
  margin: 0;
  padding: 0 32px;
}

.mdl-card__title-text {
    padding: 0 5em;
    width: 100%;
}

.users-list-card > .mdl-list > .mdl-list__item {
  padding: 0;
}

.users-list-card > .mdl-list > .mdl-list__item .mdl-textfield {
  padding: 0;
}

.users-list-card > .mdl-list > .mdl-list__item .mdl-textfield .mdl-textfield__input {
  border: none;
  top: 0;
}

.users-list-card > .mdl-card__supporting-text > .mdl-list {
  margin: 0;
  padding: 0;
}

.mdl-card__supporting-text {
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    overflow-y: scroll !important;
}

.mdl-list__item-avatar {
  background: url("https://unsplash.it/200?random") no-repeat center center;
  background-size: cover;
}

.expand-icons {
    height: auto;
    width: 1.7em;
    text-align: center;
    cursor: pointer;
}

.favorite,
.nonfavorite {
    margin-right: 32px;
}

.mdl-button:focus {
    outline: none;
}

.chatbox-expand-btn {
    height: 2;
    width: auto;
    cursor: pointer;
}
</style>

<div class="chatbox-wrapper">
    <div class="users-list-card mdl-card mdl-shadow--2dp">
        <div class="mdl-card__title">
        <p class="mdl-card__title-text">Users</p>
        </div>
        <div class="mdl-card__menu">
        <a class="chatbox-expand-btn" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
            <img class="expand-icons" src="{{ url_for('static', filename='dots-expand.png') }}">
            <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 42px, 0px);">
                <a class="dropdown-item" href="#">Minimize</a>
                <a class="dropdown-item" href="#">Go offline</a>
            </div>
        </a>
        </div>
        <div class="mdl-menu__item--full-bleed-divider"></div>
        <ul class="mdl-list">
        <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
            <div class="mdl-textfield mdl-js-textfield">
                <input class="mdl-textfield__input search" type="text" id="sample1" placeholder="Search a user...">
                </div>
            </span>
        </li>
        </ul>
        <div class="mdl-menu__item--full-bleed-divider"></div>
        <div class="mdl-card__supporting-text">
        <ul class="mdl-list">
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="fas fa-star favorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Garrett Gutierrez
            </span>
            </li>
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="fas fa-star favorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Marc Graves
            </span>
        </ul>
        <ul class="mdl-list">
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="far fa-star nonfavorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Aaron Bennett
            </span>
            </li>
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="far fa-star nonfavorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Abbey Christensen
            </span>
            </li>
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="far fa-star nonfavorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Ali Connors
            </span>
            </li>
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="far fa-star nonfavorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Alex Nelson
            </span>
            </li>
            <li class="mdl-list__item">
            <span class="mdl-list__item-primary-content">
                <i class="far fa-star nonfavorite"></i>
                <i class="mdl-list__item-avatar"></i>
                Anthony Stevens
            </span>
            </li>
        </ul>
        </div>
    </div>
</div>

<!-- SOCKETIO -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.1/socket.io.js"></script>
<!-- Chat Box JS -->
<script src="https://code.getmdl.io/1.1.2/material.min.js"></script>


<script type="text/javascript">
$(document).ready(function() {
    // NEED TO CHANGE THIS WHEN IN PRODUCTION
    var socket = io.connect('http://localhost:5000');

    socket.on('connect', function() {
        console.log('User connected to chat!');
        socket.emit('chatlist', '');
    });

    socket.on('chatlist', function(users) {
        for (i=0; i < users.length; i++) {
            console.log(users[i]['username']);
        }
        setTimeout(function(){ socket.emit('chatlist', users); }, 1000);
    });

    socket.on('message', function(msg) {
        $('#messages').append($('<li>').text(msg));
        console.log('Received message');
    });

    $('.chatbox-expand-btn').on('click', function() {
        socket.emit('chatlist');
    });
});
</script>